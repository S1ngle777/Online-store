<?php

namespace Database\Seeders;

use App\Models\Post;
use App\Models\User;
use Illuminate\Database\Seeder;
use Illuminate\Support\Str;
use Carbon\Carbon;

class PostSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        // Убедимся, что у нас есть админ
        $admin = User::where('role', 'admin')->first();

        if (!$admin) {
            // Если админ не найден, используем первого пользователя
            $admin = User::first();
        }

        // Массив для демо-статей
        $posts = [
            [
                'title' => 'Секреты изготовления молдавской керамики',
                'slug' => 'secrets-of-moldavian-ceramics',
                'content' => "Молдавская керамика известна своей уникальной техникой изготовления и характерными орнаментами.\n\nПроцесс начинается с выбора правильной глины, которая добывается в определенных регионах Молдовы. Затем она тщательно очищается и замешивается до нужной консистенции.\n\nМастера используют гончарный круг, некоторые из которых передаются по наследству. После формирования изделие оставляют сохнуть, затем обжигают в специальных печах.\n\nРаскрашивание - отдельное искусство. Используются натуральные красители, а орнаменты наносятся вручную тонкими кистями. Финальный обжиг закрепляет краску и придает изделию характерный блеск.",
                'is_published' => true,
                'published_at' => Carbon::now()->subDays(10),
                'image' => 'posts/ceramics.jpg',
            ],
            [
                'title' => 'Современные тенденции в национальной одежде',
                'slug' => 'modern-trends-in-national-clothing',
                'content' => "Национальный костюм Молдовы эволюционирует, сохраняя свою аутентичность, но адаптируясь к современным реалиям.\n\nДизайнеры включают традиционные элементы, такие как «алтица» (вышивка на рукавах), в повседневную одежду. Популярны блузки в национальном стиле, которые хорошо сочетаются с деловым костюмом или джинсами.\n\nМы предлагаем коллекцию, где традиционные вышивки и орнаменты гармонично вписываются в современный крой. Это позволяет носить частичку национальной культуры каждый день, а не только по праздникам.",
                'is_published' => true,
                'published_at' => Carbon::now()->subDays(5),
                'image' => 'posts/clothing.jpg',
            ],
            [
                'title' => 'Инновации в традиционных ремеслах',
                'slug' => 'innovations-in-traditional-crafts',
                'content' => "Как традиционные ремесла адаптируются к современному миру? Наши мастера находят инновационные подходы, сохраняя культурное наследие.\n\nИспользование новых материалов и технологий позволяет создавать более долговечные изделия, сохраняющие традиционный вид. Например, водостойкие покрытия для деревянных изделий или специальная обработка текстиля для предотвращения выгорания ярких красок.\n\nЦифровое проектирование помогает создавать сложные орнаменты, которые затем воплощаются вручную. Это сочетание технологии и ручного труда делает каждое изделие уникальным.",
                'is_published' => false, // Черновик
                'published_at' => null,
                'image' => 'posts/innovation.jpg',
            ],
            [
                'title' => 'Как выбрать аутентичный молдавский сувенир',
                'slug' => 'how-to-choose-authentic-moldavian-souvenir',
                'content' => "Хотите привезти домой настоящий молдавский сувенир? Вот несколько советов, как отличить аутентичное изделие.\n\nОбратите внимание на качество материалов и отделки. Настоящие мастера уделяют внимание каждой детали.\n\nИзучите орнаменты - у традиционных молдавских узоров есть характерные особенности. Например, геометрические формы и растительные мотивы имеют символическое значение.\n\nПоинтересуйтесь историей изделия. Настоящие ремесленники с удовольствием расскажут о процессе создания и значении различных элементов.\n\nВсе наши изделия сопровождаются сертификатом аутентичности с информацией о мастере и регионе происхождения.",
                'is_published' => true,
                'published_at' => Carbon::now()->subDays(2),
                'image' => 'posts/souvenirs.jpg',
            ],
        ];

        foreach ($posts as $postData) {
            Post::create([
                'title' => $postData['title'],
                'slug' => $postData['slug'],
                'content' => $postData['content'],
                'user_id' => $admin->id,
                'is_published' => $postData['is_published'],
                'published_at' => $postData['published_at'],
                'image' => $postData['image'],
            ]);
        }

    }
}
